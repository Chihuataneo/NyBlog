<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>代理IP-零度</title>
        <link rel="icon" type="image/x-icon" href="http://nyloner.cn/static/images/head_img.png">
        <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
          <div class="container-fluid">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../home">主页</a>
            </div>

            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav">
                <li><a href="../articles">文章</a></li>
                <li><a href="../books">小书屋</a></li>
                <li class="dropdown">
                  <a href="../tools" class="dropdown-toggle" data-toggle="dropdown">工具箱 <span class="caret"></span></a>
                  <ul class="dropdown-menu" role="menu">
                    <li><a href="../proxy">代理IP</a></li>
                    <li><a href="../boxoffice">电影票房</a></li>
                  </ul>
                </li>
                <li><a href="../projects">项目</a></li>
                <li><a href="../marks">BookMarks</a></li>
              </ul>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
        <h3>
            <p style="text-align:center">高匿代理</p>
        </h3>
        <div class="container">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>IP</th>
                        <th>端口</th>
                        <th>更新时间</th>
                    </tr>
                </thead>
                <tbody id="iplist">
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
            <div style="float:right">
                <button type="button"  id="prepage" class="btn btn-primary" onclick="prepage();">上一页</button>
                <button type="button"  id="nextpage" class="btn btn-primary" onclick="nextpage();">下一页</button>
            </div>
        </div>
    </body>
    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="../static/js/bootstrap.min.js"></script>
    <script type="text/javascript">
        var page=1;
        prepage();
        function prepage(){
            if(page!=1)
            {
                page=page-1;
            }
            var request = new XMLHttpRequest();
            request.onreadystatechange=requestCallback;
            request.open("GET","../proxy?page="+page+"&num=15");
            request.send();
            function requestCallback(){
                var jsondata=eval("("+request.responseText+")");
                var items=jsondata.list;
                var setHtml="";
                $("#iplist").html(setHtml);
                for(var i=0;i<items.length;++i)
                {
                    item=items[i];
                    setHtml+="<tr>\n<td>"+(i+1)+"</td>\n";
                    setHtml+="<td>"+item.ip.toString()+"</td>\n";
                    setHtml+="<td>"+item.port.toString()+"</td>\n";
                    setHtml+="<td>"+item.time.toString()+"</td>\n</tr>\n";
                }
                $("#iplist").html(setHtml);
                document.getElementById("nextpage").disabled=false;
                if(page==1)
                {
                    document.getElementById("prepage").disabled=true;
                }
            };
        }
        function nextpage(){
            page=page+1;
            var request = new XMLHttpRequest();
            request.onreadystatechange=requestCallback;
            request.open("GET","../proxy?page="+page+"&num=15");
            request.send();
            function requestCallback(){
                var jsondata=eval("("+request.responseText+")");
                var items=jsondata.list;
                var setHtml="";
                $("#iplist").html(setHtml);
                var i;
                for(i=0;i<items.length;++i)
                {
                    item=items[i];
                    setHtml+="<tr>\n<td>"+(i+1)+"</td>\n";
                    setHtml+="<td>"+item.ip.toString()+"</td>\n";
                    setHtml+="<td>"+item.port.toString()+"</td>\n";
                    setHtml+="<td>"+item.time.toString()+"</td>\n</tr>\n";
                }
                $("#iplist").html(setHtml);
                document.getElementById("prepage").disabled=false;
                if(i<15)
                {
                    document.getElementById("nextpage").disabled=true;
                }
            };
        }
    </script>
</html>
